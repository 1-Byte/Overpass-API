<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" lang="en"></meta>
  <title>OSM Server Side Script</title>
</head>
<body>

<h1>OSM Server Side Script</h1>

<!--
offene Probleme:
- gzip-Komprimierung
- Umstellung auf Relation_
- Reorganisation von make-area
- area-query
- recurse: area-node
- Durchsetzung der Constraints
//-->

<p>
<a href="#chapter.introduction">Introduction</a><br/>
<a href="#chapter.use_cases">Use Cases</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.reverse_gazetteer">To which country belongs this location?</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.download_area">Download an entire city</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.debug_area">Why doesn't my city appear?</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.rule_example">Declare a new type of area</a><br/>
<a href="#chapter.interface_calls">Interface Calls</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.interpreter">/api/interpreter</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.get_rule">/api/get_rule</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.add_rule">/api/add_rule</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.update_rule">/api/update_rule</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.status">/api/status</a><br/>
<a href="#chapter.statements">Statements</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.conflict">conflict</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.coord_query">coord-query</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.detect_odd_nodes">detect-odd-nodes</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.foreach">foreach</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.id_query">id-query</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.item">item</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.make_area">make-area</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.print">print</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.query">query</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.recurse">recurse</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.report">report</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.union">union</a><br/>
<a href="#chapter.concepts">Concepts</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.data_structures">Data structures</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.control_flow">Control Flow</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.variables">Variables</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.other_sets">Other Sets in Scripts</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.quotas">Limits and Quotas</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.database_layout">Database Layout</a><br/>
<a href="#chapter.input_formats">Input Formats</a><br/>
<a href="#chapter.output_formats">Output Formats</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.payload">Payload</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.status_remarks">Status Remarks</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.hypertext_reports">Hypertext Reports</a><br/>
</p>

<div>
<a id="chapter.introduction"/>
<h2>Introduction</h2>
</div>

<p>
</p>

<div>
<a id="chapter.use_cases"/>
<h2>Use Cases</h2>
</div>

<p>
<a href="#section.reverse_gazetteer">To which country belongs this location?</a><br/>
<a href="#section.download_area">Download an entire city</a><br/>
<a href="#section.debug_area">Why doesn't my city appear?</a><br/>
<a href="#section.rule_example">Declare a new type of area</a><br/>
</p>

<p>The following examples are some sample use cases to give you an idea
what you can do with the system. Of course, there are many more useful
use cases, and you are kindly invited to add other use cases.</p>

<div>
<a id="section.reverse_gazetteer"/>
<h3>To which country belongs this location?</h3>
</div>

<p>
To determine in which areas a location specified by latitude and longitude lies, just change the latitude and longitude in the following script to appriate values:<br/>
<form action="api/interpreter" method="post" accept-charset="UTF-8">
  <textarea name="data" rows="3" cols="80">&lt;coord-query lat="51.25" lon="7.15"/&gt;
&lt;print mode="body"/&gt;
</textarea>
  <input type="submit" value="Explore"/>
</form><br/>
Of course, you can send this script also via any other <a href="#chapter.input_formats">way of submitting input</a> to <a href="#section.interpreter">/api/interpreter</a>. You will recieve a gzip-compressed XML-file in an <a href="#chapter.output_formats">adapted OSM format</a> that <a href="#section.payload">contains the areas</a> the location lies in.
</p>

<p>
The first command, <a href="#section.coord_query">&lt;coord-query lat="51.25" lon="7.15"/&gt;</a>, searches the database for every area that covers the location defined by the latitude and longitude values. Then it stores the result into the <a href="#section.variables">default set</a>. Afterwards, the second command <a href="#section.print">&lt;print mode="body"/&gt;</a> prints the content of the default set. The mode="body" indicates there that it shall print the <a href="#section.data_structures">id and members</a> of the area as well as is <a href="#section.data_structures">tags</a>.<br/>
</p>

<div>
<a id="section.download_area"/>
<h3>Download an entire city</h3>
</div>

<p>
<form action="api/interpreter" method="post" accept-charset="UTF-8">
  <textarea name="data" rows="8" cols="80">&lt;union&gt;
  &lt;bbox-query n="51.5" s="51.1" w="7.0" e="7.3"/&gt;
  &lt;recurse type="node-way"/&gt;
  &lt;recurse type="node-relation"/&gt;
  &lt;recurse type="way-relation"/&gt;
&lt;/union&gt;
&lt;print mode="body"/&gt;
</textarea>
  <input type="submit" value="Download"/>
</form><br/>
</p>

<div>
<a id="section.debug_area"/>
<h3>Why doesn't my city appear?</h3>
</div>

<div>
<a id="section.rule_example"/>
<h3>Declare a new type of area</h3>
</div>

<div>
<a id="chapter.interface_calls"/>
<h2>Interface Calls</h2>
</div>

<p>
<a href="#section.interpreter">/api/interpreter</a><br/>
<a href="#section.get_rule">/api/get_rule</a><br/>
<a href="#section.add_rule">/api/add_rule</a><br/>
<a href="#section.update_rule">/api/update_rule</a><br/>
<a href="#section.status">/api/status</a><br/>
</p>

<div>
<a id="section.interpreter"/>
<h3>/api/interpreter</h3>
</div>

<div>
<a id="section.get_rule"/>
<h3>/api/get_rule</h3>
</div>

<div>
<a id="section.add_rule"/>
<h3>/api/add_rule</h3>
</div>

<div>
<a id="section.update_rule"/>
<h3>/api/update_rule</h3>
</div>

<div>
<a id="section.status"/>
<h3>/api/status</h3>
</div>

<div>
<a id="chapter.statements"/>
<h2>Statements</h2>
</div>

<p>
<a href="#section.conflict">conflict</a><br/>
<a href="#section.coord_query">coord-query</a><br/>
<a href="#section.detect_odd_nodes">detect-odd-nodes</a><br/>
<a href="#section.foreach">foreach</a><br/>
<a href="#section.id_query">id-query</a><br/>
<a href="#section.item">item</a><br/>
<a href="#section.make_area">make-area</a><br/>
<a href="#section.print">print</a><br/>
<a href="#section.query">query</a><br/>
<a href="#section.recurse">recurse</a><br/>
<a href="#section.report">report</a><br/>
<a href="#section.union">union</a><br/>
</p>

<div>
<a id="section.conflict"/>
<h3>conflict</h3>
</div>

<div>
<a id="section.coord_query"/>
<h3>coord-query</h3>
</div>

<div>
<a id="section.detect_odd_nodes"/>
<h3>detect-odd-nodes</h3>
</div>

<div>
<a id="section.foreach"/>
<h3>foreach</h3>
</div>

<div>
<a id="section.id_query"/>
<h3>id-query</h3>
</div>

<div>
<a id="section.item"/>
<h3>item</h3>
</div>

<div>
<a id="section.make_area"/>
<h3>make-area</h3>
</div>

<div>
<a id="section.print"/>
<h3>print</h3>
</div>

<div>
<a id="section.query"/>
<h3>query</h3>
</div>

<div>
<a id="section.recurse"/>
<h3>recurse</h3>
</div>

<div>
<a id="section.report"/>
<h3>report</h3>
</div>

<div>
<a id="section.union"/>
<h3>union</h3>
</div>


<div>
<a id="chapter.concepts"/>
<h2>Concepts</h2>
</div>

<p>
<a href="#section.data_structures">Data structures</a><br/>
<a href="#section.control_flow">Control Flow</a><br/>
<a href="#section.variables">Variables</a><br/>
<a href="#section.other_sets">Other Sets in Scripts</a><br/>
<a href="#section.quotas">Limits and Quotas</a><br/>
<a href="#section.database_layout">Database Layout</a><br/>
</p>

<div>
<a id="section.data_structures"/>
<h3>Data structures</h3>
</div>

<div>
<a id="section.control_flow"/>
<h3>Control Flow</h3>
</div>

<div>
<a id="section.variables"/>
<h3>Variables</h3>
</div>

<div>
<a id="section.other_sets"/>
<h3>Other Sets in Scripts</h3>
</div>

<div>
<a id="section.quotas"/>
<h3>Limits and Quotas</h3>
</div>

<div>
<a id="section.database_layout"/>
<h3>Database Layout</h3>
</div>

<div>
<a id="chapter.input_formats"/>
<h2>Input Formats</h2>
</div>

<p>
</p>

<div>
<a id="chapter.output_formats"/>
<h2>Output Formats</h2>
</div>

<p>
<a href="#section.payload">Payload</a><br/>
<a href="#section.status_remarks">Status Remarks</a><br/>
<a href="#section.hypertext_reports">Hypertext Reports</a><br/>
</p>

<div>
<a id="section.payload"/>
<h3>Payload</h3>
</div>

<div>
<a id="section.status_remarks"/>
<h3>Status Remarks</h3>
</div>

<div>
<a id="section.hypertext_reports"/>
<h3>Hypertext Reports</h3>
</div>

</body>
</html>
