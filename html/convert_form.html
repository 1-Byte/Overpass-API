<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" lang="en"></meta>
  <title>OSM Server Side Script</title>
</head>
<body>

<h1>Convert form</h1>

<form action="api/convert" method="get" accept-charset="UTF-8">
<p>
<textarea name="data" rows="25" cols="80"></textarea>
<input type="radio" name="target" value="xml">to pretty XML
<input type="radio" name="target" value="mapql">to pretty Overpass QL
<input type="radio" name="target" value="compact">to compact Overpass QL
<input type="radio" name="target" value="openlayers">to OpenLayers overlay
<input type="submit" value="Convert"/>
</p>
</form>

<h1>Overpass QL</h1>

<p>A valid input is a sequence of one or more statements, where each statement ends with a double colon ";". Stataments are actions, queries or the initial declaration. You may add any amount of whitespace you like between two statements or immediately before the double colon.</p>

<p>The only exisiting action so far is <em>out</em>. Thus e.g. "out;" is a valid action. Possible variants are to add one of the modifiers below between <em>em</em> and the double colon:</p>
<ul>
<li><em>ids</em>: Print only the id of each element.</li>
<li><em>skel</em>: Print ids, coordinates and memberships.</li>
<li><em>body</em>: Print the complete spatial data.</li>
<li><em>meta</em>: Print the complete spatial and meta data.</li>
<li><em>quirks</em>: Fake the meta data to cope with overzealous parsers. Not yet implemented.</li>
<li><em>qt</em>: Order by quadtile instead of id.</li>
<li><em>asc</em>: Order printed elements by id.</li>
</ul>
<p>The default options are <em>body</em> and <em>asc</em>.</p>

<p>A query starts with the type of the result. This can be <em>node</em>, <em>way</em>, <em>relation</em> or <em>rel</em> (shortcut for relation). After the type follow one or more clauses. The individual clauses all have brackets or parentheses and hance are written without double colon one after another.</p>

<p>The following clauses are possible:</p>
<ul>
<li><em>bbox</em>: written as <em>(</em>south<em>,</em>west<em>,</em>north<em>,</em>east<em>)</em>. An example is <pre>node[highway=bus_stop](50.6,6.8,50.9,7.2);out;</pre>.</li>
<li><em>id</em>: written as <em>(</em>ref<em>)</em>, where <em>ref</em> is the id of the referred element. An example is <pre>rel(62478);out;</pre></li>
<li><em>has-kv</em>: written as <em>[&quot;</em>key<em>&quot;=&quot;</em>value<em>&quot;]</em> or <em>[&quot;</em>key<em>&quot;]</em>. The former selects all elements where the key has the given value, the latter selects all elements where the key has any nonempty value. The quotations marks can be omitted if the entire string contains only alphanumeric characters. Example: <pre>way[name="Adelheidisstraße"];out;</pre>.</li>
<li><em>recurse</em>: written as <em>(w.</em>input set<em>)</em>, <em>(r.</em>input set<em>)</em>, <em>(bn.</em>input set<em>)</em>, <em>(bw.</em>input set<em>)</em>, or <em>(br.</em>input set<em>)</em>. Determines the origin from with the given type of elements should be derived. The input set including the leading dot can be omitted. It then default to <em>_</em>. Examples are <pre>way[name="Adelheidisstraße"]node(w);out;</pre> and <pre>way[name="Adelheidisstraße"]->.foo node(w.foo);out;</pre>.</li>
<li><em>around</em>: written as <em>(around.</em>input set<em>:</em>radius<em>)</em>. The around statement currently is only compatible to output of type node, and I even haven't decided on the semantics for the other cases. The input set including the leading dot can be omitted. It then default to <em>_</em>. An example is <pre>node[name=&quot;Lichtscheid&quot;];node(around:1000)[highway=bus_stop];out;</pre>.</li>
<li><em>user/uid</em>: written as <em>(user:&quot;</em>name<em>&quot;)</em> resp. <em>(uid:</em>id<em>)</em>. Selects all elements last touched by the given user. The user can be selected by her user name (use <em>user</em>) or user id (use <em>uid</em>). Examples are <pre>way(user:"Roland Olbricht");out;</pre> or <pre>way(uid:65282);out;</pre>.</li>
<li><em>newer</em>: similar to <em>user</em>.</li>
</ul>

<p>The initial declaration can be omitted if nothing must be declared. Otherwise, all declarations are enclosed in brackets and written one after another (without a double colon). Possible declarations are:</p>
<ul>
<li><em>timeout</em>: Select the maximum allowed runtime in seconds. The default value is 180. Use a higher value if except a large result or complex query.</li>
<li><em>maxsize</em>: Select the maximum allowed RAM size of the query on the server. If you expect a large result or complex query, you can manually raise this bound to up to 1073741824 (=1024^3).</li>
<li><em>out</em>: Select the output format. POssible values are <em>json</em> or <em>xml</em>. Default is <em>xml</em>.</li>
</ul>

</body>
</html>
